## 读开源项目《antd-design》源代码第一天

今天开始仔细阅读《antd-design》源码，今天看了源码部分的`compontents`重的`button`,本身就知道它一定很有难度，所以刚开始就选择了我认为较简单的`button`部分，在本地跑起来后，进入到 button 页面，再仔细观看源码部分，我有点吃惊，仿佛打开了新的认知。

组件页面的每个小例子竟然都是一篇独立的`markdown`,通过多篇`markdown`组成了一整个页面，一方面认识到原来`markdown`还可以这么用，之前还一直很好奇这么多例子，写在每个页面中，代码一定特别繁琐，这样看来，果真是我太小白了。

接着我开始仔细翻阅`button`中的主要代码。第一遍我先把整页代码过了一遍，看看能不能读清楚，完整的理解下来，结果我发现了许多不认识的方法函数，和不明所以的函数，因此开始慢速的读第二遍。开始记录一些，我不清楚的点，和之前没见到过，第一次见到的点。

### 记录未明白的地方

#### 项目结构

我大概看了一下项目结构，起初我认为每个组件是一个独立的页面所构成的，但是我看到`button`文件的代码中，还有许多的逻辑，因此我猜想整体的页面可能就只有首页，组件页，文档页这类，所有的组件应该是复用了一套逻辑，既然我现在要看组件页，那这里的代码一定是各个按钮如何构成和这其中的各种复杂逻辑。想明白这些，我决定耐心的去看每一行代码。（在最近的学习与探索过程中，我发现在学习新的东西的时候，刚开始一定会有许多许多不认识，不明白的东西，这种时候更加不可心急，反而更应该耐下心来，一点一点看，一点一点的去分析去理解）

#### 从代码中学习

```tsx
const rxTwoCNChar = /^[\u4e00-\u9fa5]{2}$/;
const isTwoCNChar = rxTwoCNChar.test.bind(rxTwoCNChar);
function isString(str: any) {
  return typeof str === 'string';
}

function isUnborderedButtonType(type: ButtonType | undefined) {
  return type === 'text' || type === 'link';
}
// Insert one space between two chinese characters automatically.
function insertSpace(child: React.ReactChild, needInserted: boolean) {
  // Check the child if is undefined or null.
  if (child == null) {
    return;
  }
  const SPACE = needInserted ? ' ' : '';
  // strictNullChecks oops.
  if (
    typeof child !== 'string' &&
    typeof child !== 'number' &&
    isString(child.type) &&
    isTwoCNChar(child.props.children)
  ) {
    return cloneElement(child, {
      children: child.props.children.split('').join(SPACE),
    });
  }
  if (typeof child === 'string') {
    if (isTwoCNChar(child)) {
      child = child.split('').join(SPACE);
    }
    return <span>{child}</span>;
  }
  return child;
}
```

在代码的开头，我就开始不明白了，我首先查询了`rxTwoCnchar`的声明，然后明白这些是强大的正则匹配，和jQuery的知识！查过之后才明白，这里是用 jQuery 为文本绑定了一个方法：用正则匹配将每个字符串都分隔开，为之后为字体中间加空格做准备。

jQuery:
1. `.text`: 设置或返回所选元素的文本内容。

2. `.bind`: 绑定事件，为所选元素添加一个或者多个事件处理程序，以及当事件发生时运行的函数。

接着我又查询了`split`和`join`的用法。`split`是 Python 中通过制定分隔符对字符串进行切片，如果有 num ,则代表分隔 num +1 个字符串。`join`是 SQL 中的连接，我将它理解为数学中多个集合的交集的结果，根据需要取不同的结果部分，就是将符合`join`中的所有条件的值都组合起来。

然后还认识了一个 React 的一个克隆 API `cloneElement`,此 API 以 element 元素为样板克隆并且返回新的 React 元素，注意： **新的子元素将取代现有的子元素，而来自原始的元素的 key 和 ref 将被保留。**

React.cloneElement()几乎等同于：

```tsx
<element.type {...element.props} {...props}>{children}</element.type>
```

#### 暂时总结

今天暂时先探究到这里啦！想不到通过读源码可以学到更多更广的知识，每一行代码都有可学习的地方。
