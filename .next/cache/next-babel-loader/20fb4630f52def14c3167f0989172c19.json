{"ast":null,"code":"var _jsxFileName = \"/Users/guoqi/workspace/hello-web-/component/Canvas/Canvas.tsx\";\nvar __jsx = React.createElement;\nimport React from 'react';\nconst HOOK_SVG = 'm129.03125 63.3125c0-34.914062-28.941406-63.3125-64.519531-63.3125-35.574219 0-64.511719 28.398438-64.511719 63.3125 0 29.488281 20.671875 54.246094 48.511719 61.261719v162.898437c0 53.222656 44.222656 96.527344 98.585937 96.527344h10.316406c54.363282 0 98.585938-43.304688 98.585938-96.527344v-95.640625c0-7.070312-4.640625-13.304687-11.414062-15.328125-6.769532-2.015625-14.082032.625-17.960938 6.535156l-42.328125 64.425782c-4.847656 7.390625-2.800781 17.3125 4.582031 22.167968 7.386719 4.832032 17.304688 2.792969 22.160156-4.585937l12.960938-19.71875v42.144531c0 35.582032-29.863281 64.527344-66.585938 64.527344h-10.316406c-36.714844 0-66.585937-28.945312-66.585937-64.527344v-162.898437c27.847656-7.015625 48.519531-31.773438 48.519531-61.261719zm-97.03125 0c0-17.265625 14.585938-31.3125 32.511719-31.3125 17.929687 0 32.511719 14.046875 32.511719 31.3125 0 17.261719-14.582032 31.3125-32.511719 31.3125-17.925781 0-32.511719-14.050781-32.511719-31.3125zm0 0';\nconst HOOK_PATH = new Path2D(HOOK_SVG);\nconst SCALE = 0.3;\nconst OFFSET = 80;\n\nfunction draw(ctx, location) {\n  ctx.fillStyle = 'deepskyblue';\n  ctx.shadowColor = 'dodgerblue';\n  ctx.shadowBlur = 20, ctx.save();\n  ctx.scale(SCALE, SCALE), ctx.translate(location.x / SCALE - OFFSET, location.y / SCALE - OFFSET);\n  ctx.fill(HOOK_PATH);\n  ctx.restore();\n}\n\n;\n\nfunction usePersistentState(init) {\n  const [value, setValue] = React.useState(JSON.parse(localStorage.getItem('draw-app')) || init);\n  React.useEffect(() => {\n    localStorage.setItem('draw-app', JSON.stringify(value));\n  });\n  return [value, setValue];\n} // our second custom hook: a composition of the first custom hook // and React's useEffect + useRef\n\n\nfunction usePersistentCanvas() {\n  const [locations, setLocations] = usePersistentState([]);\n  const canvasRef = React.useRef(null);\n  React.useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);\n    locations.forEach(location => draw(ctx, location));\n  });\n  return [locations, setLocations, canvasRef];\n}\n\nfunction App() {\n  const [locations, setLocations, canvasRef] = usePersistentCanvas();\n\n  function handleCanvasClick(e) {\n    const newLocation = {\n      x: e.clientX,\n      y: e.clientY\n    };\n    setLocations([...locations, newLocation]);\n  }\n\n  function handleClear() {\n    setLocations([]);\n  }\n\n  function handleUndo() {\n    setLocations(locations.slice(0, -1));\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"controls\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, __jsx(\"button\", {\n    onClick: handleClear,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }\n  }, \"Clear\"), __jsx(\"button\", {\n    onClick: handleUndo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }\n  }, \"Undo\")), __jsx(\"canvas\", {\n    ref: canvasRef,\n    width: window.innerWidth,\n    height: window.innerHeight,\n    onClick: handleCanvasClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/guoqi/workspace/hello-web-/component/Canvas/Canvas.tsx"],"names":["React","HOOK_SVG","HOOK_PATH","Path2D","SCALE","OFFSET","draw","ctx","location","fillStyle","shadowColor","shadowBlur","save","scale","translate","x","y","fill","restore","usePersistentState","init","value","setValue","useState","JSON","parse","localStorage","getItem","useEffect","setItem","stringify","usePersistentCanvas","locations","setLocations","canvasRef","useRef","canvas","current","getContext","clearRect","window","innerWidth","innerHeight","forEach","App","handleCanvasClick","e","newLocation","clientX","clientY","handleClear","handleUndo","slice"],"mappings":"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","sourcesContent":["import React from 'react';\n\ntype Props = {\n  Path2D: void;\n}\n\nconst HOOK_SVG = 'm129.03125 63.3125c0-34.914062-28.941406-63.3125-64.519531-63.3125-35.574219 0-64.511719 28.398438-64.511719 63.3125 0 29.488281 20.671875 54.246094 48.511719 61.261719v162.898437c0 53.222656 44.222656 96.527344 98.585937 96.527344h10.316406c54.363282 0 98.585938-43.304688 98.585938-96.527344v-95.640625c0-7.070312-4.640625-13.304687-11.414062-15.328125-6.769532-2.015625-14.082032.625-17.960938 6.535156l-42.328125 64.425782c-4.847656 7.390625-2.800781 17.3125 4.582031 22.167968 7.386719 4.832032 17.304688 2.792969 22.160156-4.585937l12.960938-19.71875v42.144531c0 35.582032-29.863281 64.527344-66.585938 64.527344h-10.316406c-36.714844 0-66.585937-28.945312-66.585937-64.527344v-162.898437c27.847656-7.015625 48.519531-31.773438 48.519531-61.261719zm-97.03125 0c0-17.265625 14.585938-31.3125 32.511719-31.3125 17.929687 0 32.511719 14.046875 32.511719 31.3125 0 17.261719-14.582032 31.3125-32.511719 31.3125-17.925781 0-32.511719-14.050781-32.511719-31.3125zm0 0';\nconst HOOK_PATH = new Path2D(HOOK_SVG);\nconst SCALE = 0.3;\nconst OFFSET = 80;\nfunction draw(ctx, location) {\n  ctx.fillStyle = 'deepskyblue'\n  ctx.shadowColor = 'dodgerblue'\n  ctx.shadowBlur = 20, ctx.save()\n  ctx.scale(SCALE, SCALE), ctx.translate(location.x / SCALE - OFFSET, location.y / SCALE - OFFSET)\n  ctx.fill(HOOK_PATH)\n  ctx.restore()\n};\n\nfunction usePersistentState(init) {\n  const [value, setValue] = React.useState(\n    JSON.parse(localStorage.getItem('draw-app')) || init\n  )\n  React.useEffect(() => {\n    localStorage.setItem('draw-app', JSON.stringify(value))\n  })\n  return [value, setValue]\n}\n// our second custom hook: a composition of the first custom hook // and React's useEffect + useRef\nfunction usePersistentCanvas() {\n  const [locations, setLocations] = usePersistentState([])\n  \n  const canvasRef = React.useRef(null)\n  \n  React.useEffect(() => {\n    const canvas = canvasRef.current\n    const ctx = canvas.getContext('2d')\n    ctx.clearRect(0, 0, window.innerWidth, window.innerHeight)\n    locations.forEach(location => draw(ctx, location))\n  })\n  return [locations, setLocations, canvasRef]\n}\nfunction App() {\n  const [locations, setLocations, canvasRef] = usePersistentCanvas()\n  function handleCanvasClick(e) {\n    const newLocation = { x: e.clientX, y: e.clientY }\n    setLocations([...locations, newLocation])\n  }\n  function handleClear() {\n    setLocations([])\n  }\n  function handleUndo() {\n    setLocations(locations.slice(0, -1))\n  }\n  return (\n    <>\n      <div className=\"controls\">\n        <button onClick={handleClear}>Clear</button>\n        <button onClick={handleUndo}>Undo</button>\n      </div>\n      <canvas\n        ref={canvasRef}\n        width={window.innerWidth}\n        height={window.innerHeight}\n        onClick={handleCanvasClick}\n      />\n    </>\n  )\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}